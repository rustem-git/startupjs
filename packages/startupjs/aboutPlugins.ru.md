# Плагины в Startupjs

- [Как создать плагин](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/createPlugin.ru.md)
- [Хуки для плагинов](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/README.ru.md)

## Что такое плагины и зачем они нужны

Платформа startupjs поддерживает систему плагинов, которая позволяет легко интегрировать дополнительные модули в приложение, расширяя таким образом функциональность самого приложения. Эти модули мы и будем называть плагинами. С помощью плагинов можно добавлять новые компоненты, маршруты, функциональность сервера и многое другое, что позволит нам адаптировать приложение под конкретные потребности. Причем все это становится доступным без необходимости изменения основного кода приложения.

В целом, система плагинов в startupjs обеспечивает гибкость и расширяемость при разработке веб-приложений, что делает его привлекательным выбором для многих разработчиков.


## Как работает система плагинов

1) Создание плагина: Разработчики создают плагины в отдельных файлах вида *.plugin.js. Плагины создаются с помощью функции createPlugin.

2) Регистрация плагинов: Разработчики регистрируют плагины в приложении, указывая информацию о них в специальных местах: это файлы package.json и startupjs.config.cjs.

3) Инициализация плагинов: При старте приложения система запускает зарегистрированные плагины. Вся функциональность производится благодаря хукам, которые предоставляет плагин.

4) Хуки и события: Плагины могут подписываться на определенные события, которые генерируются внутри приложения, и реагировать на них выполнением определенных действий. При наступлении события система запускает соответствующие плагины, позволяя им выполнить свою логику. Это может быть изменение состояния приложения, отправка HTTP-запросов, обработка данных и т.д. Отслеживание событий производится с помощью хуков.

Подробнее о том, как создать плагин вы можете ознакомиться [здесь](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/createPlugin.ru.md)


## Виды хуков

В системе плагинов startupjs особенность заключается в том, что она предоставляет разработчикам гибкий механизм для управления кодом в зависимости от среды выполнения (environment), то есть от того, запускается ли приложение на клиентской стороне (браузере), серверной стороне (Node.js) или в обеих средах одновременно (изоморфное приложение).

При создании плагина разработчик может явно указать, для какой среды выполнения (client, server или isomorphic) предназначен тот или иной хук.

Так, при создании плагина, работающего на серверной стороне (например, для обработки HTTP-запросов, настройки API, выполнения вычислений на сервере и т.д), мы используем серверные хуки и описываем их в функции server. Приведем простой пример такого плагина (более детально о создании плагинов мы расскажем позже)

```js
export default createPlugin({
  name: 'my-plugin',
  server: (pluginOptions) => ({
    // Здесь может быть добавлена реализация серверных хуков
  })
})
```

Клиентские хуки предназначены для выполнения на клиентской стороне приложения, например, для инициализации клиентских компонент и описываются в функции client.

```js
export default createPlugin({
  name: 'my-plugin',
  client: (pluginOptions) => ({
    // Здесь может быть добавлена реализация клиентских хуков
  })
})
```

Изоморфные хуки могут выполняться как на клиентской, так и на серверной стороне приложения. Это позволяет совместно использовать код между клиентом и сервером, что упрощает разработку и поддержку приложения. Такие хуки описываются в функции isomorphic.

```js
export default createPlugin({
  name: 'my-plugin',
  isomorphic: (pluginOptions) => ({
    // Здесь может быть добавлена реализация изоморфных хуков
  })
})
```

Технически, client, server и isomorphic - это функции, которые принимают пользовательские опции (pluginOptions) и возвращают объект с различными хуками, содержащими свои настройки и функциональность, которые связаны с клиентской частью, серверной или и той, и другой одновременно.

Зачем делить код по средам выполнения?

Когда приложение компилируется или собирается для конкретного окружения, некоторые части кода могут быть исключены из итоговой сборки, чтобы оптимизировать ее для этой среды выполнения.

Давайте предположим, что у нас есть плагин с хуком, который должен выполняться только на серверной стороне.
Когда проект компилируется для серверной стороны, этот код остается в итоговой сборке, и плагин будет инициализирован при запуске сервера.

Однако, если проект компилируется для клиентской стороны, где серверные хуки не нужны, эти части кода могут быть исключены из сборки, чтобы уменьшить размер клиентского JavaScript-файла и избежать возможных проблем с безопасностью или производительностью.

Таким образом, вырезание кода - это процесс оптимизации сборки проекта для конкретного окружения путем исключения из него ненужных частей кода, что позволяет улучшить производительность и сделать конечную сборку более эффективной.

Подробнее о хуках вы можете ознакомиться [здесь](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/README.ru.md)


## Узнайте больше о системе плагинов:
- [Как создать плагин](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/createPlugin.ru.md)
- [Хуки для плагинов](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/README.ru.md)
