# Плагины в Startupjs

- [Как создать плагин](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/createPlugin.ru.md)
- [Хуки для плагинов](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/README.ru.md)

## Что такое плагины и зачем они нужны

Платформа startupjs поддерживает систему плагинов, которая позволяет легко интегрировать дополнительные модули в приложение, расширяя таким образом функциональность самого приложения. Эти модули мы и будем называть плагинами. С помощью плагинов можно добавлять новые компоненты, маршруты, функциональность сервера и многое другое, что позволит нам адаптировать приложение под конкретные потребности. Причем все это становится доступным без необходимости изменения основного кода приложения.

В целом, система плагинов в startupjs обеспечивает гибкость и расширяемость при разработке веб-приложений, что делает его привлекательным выбором для многих разработчиков.


## Как работает система плагинов

1) **Создание плагина**: Разработчики создают плагины в отдельных файлах вида *.plugin.js. Плагины создаются с помощью функции createPlugin.

2) **Регистрация плагинов**: Разработчики регистрируют плагины в приложении, указывая информацию о них в специальных местах: это файлы package.json и startupjs.config.js.

3) **Инициализация плагинов**: При старте приложения система запускает зарегистрированные плагины. Вся функциональность производится благодаря хукам, которые предоставляет плагин.

4) **Хуки и события**: Плагины могут подписываться на определенные события, которые генерируются внутри приложения, и реагировать на них выполнением определенных действий. Когда возникает то или иное событие, система запускает соответствующие плагины, позволяя им выполнить свою логику. Отслеживание событий производится с помощью хуков. Что может быть такими событиями? Например, сессия на сервере: мы можем выполнить код перед инициализацией сессии или после нее; можно выполнить код перед запуском сервера Express и т.д.

## Виды хуков

**Хуки** - это специальные функции, которые используются в системе плагинов startupjs для определения функциональности плагинов в разных средах выполнения, иными словами, разработчик может явно указать, для какой среды выполнения предназначен тот или иной код. В startupjs существуют три основных типа хуков: клиентские, серверные и изоморфные.

- **Клиентские хуки**: Выполняются на клиентской стороне приложения, в браузере пользователя. Они могут содержать код, связанный с интерфейсом пользователя или клиентской логикой.

- **Серверные хуки**: Выполняются на серверной стороне приложения, в среде Node.js. Они могут содержать код, связанный с обработкой HTTP-запросов, настройкой API, выполнением вычислений на сервере и т.д.

- **Изоморфные хуки**: Выполняются как на клиентской, так и на серверной стороне приложения. Это позволяет совместно использовать код между клиентом и сервером, что упрощает разработку и поддержку приложения.

На примере это может выглядеть так:

```js
import { createPlugin } from 'startupjs';

export default createPlugin({
  name: 'myPlugin',
  client: (pluginOptions) => ({
    // Клиентские хуки
    // Код для выполнения на клиентской стороне приложения
  }),
  server: (pluginOptions) => ({
    // Серверные хуки
    // Код для выполнения на серверной стороне приложения
  }),
  isomorphic: (pluginOptions) => ({
    // Изоморфные хуки
    // Код, который должен выполняться как на клиенте, так и на сервере
  })
})
```

Технически, client, server и isomorphic - это функции, которые принимают пользовательские опции (pluginOptions) и возвращают объект с различными хуками, содержащими свои настройки и функциональность, которые связаны с клиентской частью, серверной или и той, и другой одновременно.

**Зачем делить код по средам выполнения?**

Когда приложение собирается для конкретного окружения, некоторые части кода могут быть исключены из итоговой сборки, чтобы оптимизировать ее для этой среды выполнения.

Давайте предположим, что у нас есть плагин с хуком, который должен выполняться только на серверной стороне.
Когда проект компилируется для серверной стороны, этот код остается в итоговой сборке и плагин будет инициализирован при запуске сервера.

Однако, если проект компилируется для клиентской стороны, где серверные хуки не нужны, эти части кода могут быть исключены из сборки, чтобы уменьшить размер клиентского JavaScript-файла и избежать возможных проблем с безопасностью или производительностью.

Таким образом, вырезание кода - это процесс оптимизации сборки проекта для конкретного окружения путем исключения из него ненужных частей кода, что позволяет улучшить производительность и сделать конечную сборку более эффективной.

Подробнее о хуках вы можете ознакомиться [здесь](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/README.ru.md)


## Узнайте больше о системе плагинов:
- [Как создать плагин](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/createPlugin.ru.md)
- [Хуки для плагинов](https://github.com/startupjs/startupjs/blob/master/packages/startupjs/README.ru.md)
